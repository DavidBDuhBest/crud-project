{"version":3,"sources":["index.js"],"names":["Object","defineProperty","exports","value","suppressOthers","supportsInert","inertOthers","hideOthers","getDefaultParent","originalTarget","document","sampleTarget","Array","isArray","ownerDocument","body","counterMap","WeakMap","uncontrolledNodes","markerMap","lockCount","applyAttributeToOthers","parentNode","markerName","controlAttribute","targets","markerCounter","hiddenNodes","elementsToKeep","Set","elementsToStop","keep","el","has","add","forEach","deep","parent","prototype","call","children","node","attr","getAttribute","alreadyHidden","counterValue","get","markerValue","set","push","setAttribute","clear","removeAttribute","delete","from","activeParentNode","apply","querySelectorAll","HTMLElement","hasOwnProperty"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.suppressOthers = exports.supportsInert = exports.inertOthers = exports.hideOthers = void 0;\nvar getDefaultParent = function (originalTarget) {\n    if (typeof document === 'undefined') {\n        return null;\n    }\n    var sampleTarget = Array.isArray(originalTarget) ? originalTarget[0] : originalTarget;\n    return sampleTarget.ownerDocument.body;\n};\nvar counterMap = new WeakMap();\nvar uncontrolledNodes = new WeakMap();\nvar markerMap = {};\nvar lockCount = 0;\n/**\n * Marks everything except given node(or nodes) as aria-hidden\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @param {String} [controlAttribute] - html Attribute to control\n * @return {Undo} undo command\n */\nvar applyAttributeToOthers = function (originalTarget, parentNode, markerName, controlAttribute) {\n    var targets = Array.isArray(originalTarget) ? originalTarget : [originalTarget];\n    if (!markerMap[markerName]) {\n        markerMap[markerName] = new WeakMap();\n    }\n    var markerCounter = markerMap[markerName];\n    var hiddenNodes = [];\n    var elementsToKeep = new Set();\n    var elementsToStop = new Set(targets);\n    var keep = function (el) {\n        if (!el || elementsToKeep.has(el)) {\n            return;\n        }\n        elementsToKeep.add(el);\n        keep(el.parentNode);\n    };\n    targets.forEach(keep);\n    var deep = function (parent) {\n        if (!parent || elementsToStop.has(parent)) {\n            return;\n        }\n        Array.prototype.forEach.call(parent.children, function (node) {\n            if (elementsToKeep.has(node)) {\n                deep(node);\n            }\n            else {\n                var attr = node.getAttribute(controlAttribute);\n                var alreadyHidden = attr !== null && attr !== 'false';\n                var counterValue = (counterMap.get(node) || 0) + 1;\n                var markerValue = (markerCounter.get(node) || 0) + 1;\n                counterMap.set(node, counterValue);\n                markerCounter.set(node, markerValue);\n                hiddenNodes.push(node);\n                if (counterValue === 1 && alreadyHidden) {\n                    uncontrolledNodes.set(node, true);\n                }\n                if (markerValue === 1) {\n                    node.setAttribute(markerName, 'true');\n                }\n                if (!alreadyHidden) {\n                    node.setAttribute(controlAttribute, 'true');\n                }\n            }\n        });\n    };\n    deep(parentNode);\n    elementsToKeep.clear();\n    lockCount++;\n    return function () {\n        hiddenNodes.forEach(function (node) {\n            var counterValue = counterMap.get(node) - 1;\n            var markerValue = markerCounter.get(node) - 1;\n            counterMap.set(node, counterValue);\n            markerCounter.set(node, markerValue);\n            if (!counterValue) {\n                if (!uncontrolledNodes.has(node)) {\n                    node.removeAttribute(controlAttribute);\n                }\n                uncontrolledNodes.delete(node);\n            }\n            if (!markerValue) {\n                node.removeAttribute(markerName);\n            }\n        });\n        lockCount--;\n        if (!lockCount) {\n            // clear\n            counterMap = new WeakMap();\n            counterMap = new WeakMap();\n            uncontrolledNodes = new WeakMap();\n            markerMap = {};\n        }\n    };\n};\n/**\n * Marks everything except given node(or nodes) as aria-hidden\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @return {Undo} undo command\n */\nvar hideOthers = function (originalTarget, parentNode, markerName) {\n    if (markerName === void 0) { markerName = 'data-aria-hidden'; }\n    var targets = Array.from(Array.isArray(originalTarget) ? originalTarget : [originalTarget]);\n    var activeParentNode = parentNode || getDefaultParent(originalTarget);\n    if (!activeParentNode) {\n        return function () { return null; };\n    }\n    // we should not hide ariaLive elements - https://github.com/theKashey/aria-hidden/issues/10\n    targets.push.apply(targets, Array.from(activeParentNode.querySelectorAll('[aria-live]')));\n    return applyAttributeToOthers(targets, activeParentNode, markerName, 'aria-hidden');\n};\nexports.hideOthers = hideOthers;\n/**\n * Marks everything except given node(or nodes) as inert\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @return {Undo} undo command\n */\nvar inertOthers = function (originalTarget, parentNode, markerName) {\n    if (markerName === void 0) { markerName = 'data-inert-ed'; }\n    var activeParentNode = parentNode || getDefaultParent(originalTarget);\n    if (!activeParentNode) {\n        return function () { return null; };\n    }\n    return applyAttributeToOthers(originalTarget, activeParentNode, markerName, 'inert');\n};\nexports.inertOthers = inertOthers;\n/**\n * @returns if current browser supports inert\n */\nvar supportsInert = function () {\n    return typeof HTMLElement !== 'undefined' && HTMLElement.prototype.hasOwnProperty('inert');\n};\nexports.supportsInert = supportsInert;\n/**\n * Automatic function to \"suppress\" DOM elements - _hide_ or _inert_ in the best possible way\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @return {Undo} undo command\n */\nvar suppressOthers = function (originalTarget, parentNode, markerName) {\n    if (markerName === void 0) { markerName = 'data-suppressed'; }\n    return ((0, exports.supportsInert)() ? exports.inertOthers : exports.hideOthers)(originalTarget, parentNode, markerName);\n};\nexports.suppressOthers = suppressOthers;\n"]}